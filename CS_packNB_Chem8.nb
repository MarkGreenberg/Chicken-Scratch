(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16250,        308]
NotebookOptionsPosition[     15935,        294]
NotebookOutlinePosition[     16295,        310]
CellTagsIndexPosition[     16252,        307]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"CloudDeploy", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Delayed", "[", "\[IndentingNewLine]", 
    RowBox[{"APIFunction", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"choices", "=", 
        RowBox[{"RandomSample", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<O_2+2H_2 JJJ 2H_2O\>\"", ",", 
            "\"\<7H_2O_2+2Ce(NO_3)_3 JJJ 2Ce(OH)_4+3O_2+6HNO_3\>\"", ",", 
            "\"\<Mg+HCl JJJ MgCl+H\>\"", ",", 
            "\"\<6H_2O_2+2Ce(NO_3)_3 JJJ 2Ce(OH)_3+3O_2+6HNO_3\>\"", ",", 
            "\"\<20EsO+H_20 JJJ 20EsOH\>\"", ",", 
            "\"\<4H_2O_2+Ce(NO_3)_4 JJJ Ce(OH)_4+2O_2+4HNO_3\>\"", ",", 
            "\"\<3H_2(CO_3)+2Al(OH)_3 JJJ 6H_2O+Al_2(CO_3)_3\>\"", ",", 
            "\"\<4EsO+2H_2O JJJ 4EsH+3O_2\>\"", ",", 
            "\"\<4PO_4+3Ca_2 JJJ 2Ca_3(PO_4)_2\>\"", ",", 
            "\"\<Na+CL JJJ NaCL\>\"", ",", 
            "\"\<FeCl_3+KSCN JJJ FeSCN+KCl_3\>\"", ",", 
            "\"\<H_2Br+Mg(OH)_2 JJJ 2H_2O+MgBr\>\"", ",", 
            "\"\<H_2S+2K(OH) JJJ 2H_2O+K_2S\>\"", ",", 
            "\"\<P_4+6I_2 JJJ 4PI_3\>\"", ",", "\"\<Na+Cl JJJ NaCl\>\"", ",", 
            "\"\<4Al+3MnO_2 JJJ 3Mn+2Al_2O_3\>\"", ",", 
            "\"\<Fe(NO_3)_3+3NaOH JJJ 3NaNO_3+Fe(OH)_3\>\"", ",", 
            "\"\<3Mg+2P JJJ Mg_3P_2\>\"", ",", 
            "\"\<2AgNO_3+Na_2CrO_4 JJJ 2NaNO_3+Ag_2CrO_4\>\"", ",", 
            "\"\<C_8H_8O_3+C_4H_6O_3 JJJ C_10H_10O_4+C_2H_4O_2\>\"", ",", 
            "\"\<Ba(NO_3)_2+Na_2CrO_4 JJJ 2NaNO_3+BaCrO_4\>\"", ",", 
            "\"\<Co(NO_3)_2+Na_2CrO_4 JJJ 2NaNO_3+CoCrO_4\>\"", ",", 
            "\"\<2Al+Cl_2 JJJ 2AlCl\>\"", ",", 
            "\"\<C_3H_8+5O_2 JJJ 3CO_2+4H_2O\>\"", ",", 
            "\"\<2Al+3Cl_2 JJJ 2AlCl_3\>\"", ",", 
            "\"\<4HCl+O_2 JJJ 2H_2O+2Cl_2\>\"", ",", 
            "\"\<4Al+3Cl_2 JJJ 2Al_2Cl_3\>\"", ",", 
            "\"\<2Na+Cl_2 JJJ 2NaCl\>\"", ",", "\"\<2Al+Cl_2 JJJ 2AlCl\>\"", 
            ",", "\"\<2Al+3Cl_2 JJJ 2AlCl_3\>\"", ",", 
            "\"\<2H_2+O_2 JJJ 2H_2O\>\"", ",", "\"\<3H_2+N_2 JJJ 2NH_3\>\"", 
            ",", "\"\<Al+2Cl JJJ AlCl_2\>\"", ",", 
            "\"\<H_2SO_4+Fe JJJ FeSO_4+H_2\>\"", ",", "\"\<Sr+S JJJ SrS\>\"", 
            ",", 
            "\"\<5PhCH_3+6KMnO_4+9H_2SO_4 JJJ 5PhCOOH+3K_2SO_4+6MnSO_4+14H_2O\
\>\"", ",", "\"\<3Ca+2AlCl_3 JJJ 2Al+3CaCl_2\>\"", ",", 
            "\"\<H_2SO_4+PbCO_3 JJJ PbSO_4+CO_2+H_2O\>\"", ",", 
            "\"\<3Mg+2P JJJ Mg_3P_2\>\"", ",", 
            "\"\<2Al(OH)_3+3H_2SO_4 JJJ Al_2(SO_4)_3+6H_2O\>\"", ",", 
            "\"\<CO_3+H_2O JJJ CO_2+2OH\>\"", ",", 
            "\"\<2Fe+3O JJJ Fe_2O_3\>\"", ",", 
            "\"\<CO_2+H_2O JJJ H_2CO_3\>\"", ",", 
            "\"\<CuCl_2+Na_2CO_3 JJJ 2NaCl+CuCO_3\>\"", ",", 
            "\"\<6C_4H_10+11O_2 JJJ 8CH_3CH_2CO_2H+6H_2O\>\"", ",", 
            "\"\<H_2SO_4+Sn(OH)_2 JJJ SnSO_4+2H_2O\>\"", ",", 
            "\"\<C_2H_4+Na_2PdCl_4+H_2O JJJ CH_3CHO+2HCl+2NaCl+Pd\>\""}], 
           "}"}], ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"choices", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "q", "=", 
        "\"\<Which of these chemical equations is NOT correctly \
balanced?\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"span", "=", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{"StringPosition", "[", 
          RowBox[{
           RowBox[{"choices", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"StartOfString", "|", "\"\<+\>\"", "|", "\"\<JJJ \>\""}], 
            "~~", 
            RowBox[{"DigitCharacter", "..."}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"chars", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"choices", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "span"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newChars", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"chars", ",", 
          RowBox[{
           RowBox[{"d", ":", 
            RowBox[{"DigitCharacter", ".."}]}], "\[RuleDelayed]", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"RandomChoice", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<2\>\"", ",", "\"\<3\>\"", ",", "\"\<4\>\"", ",", 
                "\"\<5\>\"", ",", "\"\<6\>\"", ",", "\"\<7\>\"", ",", 
                "\"\<8\>\""}], "}"}], "]"}], ",", "d"}], "]"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{"newChars", ",", 
           RowBox[{"___", "~~", "DigitCharacter", "~~", "___"}]}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"choices", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"StringReplacePart", "[", 
           RowBox[{
            RowBox[{"choices", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "newChars", ",", "span"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"choices", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"StringReplacePart", "[", 
           RowBox[{
            RowBox[{"choices", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"chars", "<>", 
             RowBox[{"RandomChoice", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<2\>\"", ",", "\"\<3\>\"", ",", "\"\<4\>\"", ",", 
                "\"\<5\>\"", ",", "\"\<6\>\"", ",", "\"\<7\>\"", ",", 
                "\"\<8\>\""}], "}"}], "]"}]}], ",", "span"}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"mixed", "=", 
        RowBox[{"RandomSample", "[", "choices", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ans", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"mixed", ",", 
           RowBox[{"choices", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mixed", "=", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<JJJ\>\"", "\[Rule]", 
                 RowBox[{"FromCharacterCode", "[", "8594", "]"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"c", ":", 
                   RowBox[{"LetterCharacter", "|", "\"\<)\>\""}]}], "~~", 
                  "\"\<_\>\"", "~~", 
                  RowBox[{"d", ":", 
                   RowBox[{"DigitCharacter", ".."}]}]}], "\[RuleDelayed]", 
                 " ", 
                 RowBox[{
                 "\"\<\\!\\(\\*SubscriptBox[\\\"\>\"", "<>", "c", "<>", 
                  "\"\<\\\",\\\"\>\"", "<>", "d", "<>", 
                  "\"\<\\\"]\\)\>\""}]}]}], "}"}]}], "]"}], "&"}], "/@", 
           "h1"}], "]"}], "/.", 
         RowBox[{"h1", "\[Rule]", "mixed"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"InputForm", "[", 
         RowBox[{"{", 
          RowBox[{"q", ",", "ans", ",", "mixed"}], "}"}], "]"}], "&"}]}]}], 
     "]"}], "]"}], ",", "\[IndentingNewLine]", "\"\<CS_pack_Chem8\>\"", ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.693995325987591*^9, 3.693995346682775*^9}, {
   3.69408290064557*^9, 3.6940829335552797`*^9}, {3.694191315829772*^9, 
   3.694191329645937*^9}, 3.694191371447843*^9, {3.6941921255989428`*^9, 
   3.6941921365324917`*^9}, {3.6941925901675177`*^9, 3.6941926080662813`*^9}, 
   3.6941926639271603`*^9, {3.6941927700177794`*^9, 3.6941927716993303`*^9}, 
   3.69419281323199*^9, {3.694192872366682*^9, 3.694192890423419*^9}, 
   3.6941929373574667`*^9, {3.69419302274179*^9, 3.694193103236724*^9}, {
   3.69419316760485*^9, 3.694193179184657*^9}, {3.694193220423387*^9, 
   3.6941932210319643`*^9}, {3.694193260673304*^9, 3.694193261858531*^9}, {
   3.694193313579795*^9, 3.694193314708859*^9}, {3.69419341901684*^9, 
   3.69419341968979*^9}, {3.694193451994649*^9, 3.694193453267887*^9}, {
   3.694193569951973*^9, 3.694193570992797*^9}, {3.6941936390431147`*^9, 
   3.694193641755426*^9}, {3.694193707226008*^9, 3.694193739451016*^9}, {
   3.694193777673921*^9, 3.694193779155665*^9}, {3.694193867150709*^9, 
   3.6941938678808737`*^9}, {3.694193914384536*^9, 3.694193915234363*^9}, {
   3.6941939519305897`*^9, 3.694193952708332*^9}, {3.694193996340744*^9, 
   3.6941939978537607`*^9}, {3.69419404093475*^9, 3.694194043320573*^9}, {
   3.69419409775219*^9, 3.6941941278201017`*^9}, {3.694194172173081*^9, 
   3.6941941732783747`*^9}, {3.694194206310953*^9, 3.694194207784095*^9}, {
   3.694194252505212*^9, 3.694194254562293*^9}, {3.69419429921134*^9, 
   3.694194300196456*^9}, {3.69419433980399*^9, 3.6941943407026443`*^9}, {
   3.6941944172249937`*^9, 3.69419441827425*^9}, {3.694194457810878*^9, 
   3.694194458620051*^9}, {3.694194500788968*^9, 3.694194501470179*^9}, {
   3.694194538310892*^9, 3.694194538919262*^9}, {3.69419474191264*^9, 
   3.694194742554373*^9}, {3.6941947850185623`*^9, 3.6941947864361963`*^9}, {
   3.694194836693317*^9, 3.6941948383989964`*^9}, {3.6941948755273647`*^9, 
   3.6941948765521517`*^9}, {3.69419491528905*^9, 3.694194916378867*^9}, {
   3.6941949608437643`*^9, 3.694194962052622*^9}, {3.694194992388888*^9, 
   3.6941949933817577`*^9}, {3.694195029854836*^9, 3.6941950306081257`*^9}, {
   3.694195068048622*^9, 3.694195069138281*^9}, {3.694195144292224*^9, 
   3.69419514543836*^9}, {3.6941952181438923`*^9, 3.694195233540229*^9}, {
   3.694195271938713*^9, 3.694195273982622*^9}, {3.694196035918577*^9, 
   3.694196055238661*^9}, {3.694196160771407*^9, 3.694196223027123*^9}, {
   3.6941965749969807`*^9, 3.694196575451549*^9}, {3.694196706866538*^9, 
   3.694196739485518*^9}, {3.694196779766858*^9, 3.694196826175571*^9}, {
   3.6941968912827787`*^9, 3.694196892722934*^9}, {3.694196989177856*^9, 
   3.694197225521956*^9}, {3.694197560205291*^9, 3.6941975648749447`*^9}, {
   3.694197699299036*^9, 3.694197775581335*^9}, {3.694197807045444*^9, 
   3.69419787749681*^9}, {3.694198757899849*^9, 3.694198786982595*^9}, {
   3.6941988384798603`*^9, 3.6941988426226883`*^9}, {3.694199001488722*^9, 
   3.694199037816945*^9}, {3.694199253235355*^9, 3.694199302619692*^9}, {
   3.6941993814531517`*^9, 3.694199417274559*^9}, {3.6941995880432034`*^9, 
   3.6941996276596117`*^9}, {3.694200069210352*^9, 3.6942001047222433`*^9}, {
   3.694200214987776*^9, 3.694200216630331*^9}, {3.6942002789404593`*^9, 
   3.694200304912026*^9}, {3.6942007199474297`*^9, 3.694200763432959*^9}, {
   3.694200849744604*^9, 3.694200996355839*^9}, {3.694201059736483*^9, 
   3.694201102944821*^9}, {3.6942011355560102`*^9, 3.694201161899577*^9}, {
   3.694201192167554*^9, 3.694201258568019*^9}, {3.694203238143561*^9, 
   3.694203297736792*^9}, {3.6942033471417913`*^9, 3.6942035440259657`*^9}, {
   3.6942035740315113`*^9, 3.694203601599128*^9}, {3.694203649161478*^9, 
   3.6942037917445087`*^9}, {3.6942038543247128`*^9, 3.694203968330165*^9}, {
   3.694204009595038*^9, 3.694204014715405*^9}, {3.694204352284649*^9, 
   3.69420459599118*^9}, {3.694204659443322*^9, 3.694204659699194*^9}, {
   3.694204694165551*^9, 3.694204700140077*^9}, {3.6942047487029457`*^9, 
   3.694204774728245*^9}, {3.694204848253684*^9, 3.694204911654211*^9}, {
   3.694204950537354*^9, 3.694204954200275*^9}, {3.694205349479313*^9, 
   3.6942053533153877`*^9}, {3.694205437904711*^9, 3.694205670106619*^9}, 
   3.6942057461677933`*^9, {3.6942057923616247`*^9, 3.6942058803259077`*^9}, {
   3.694253360819076*^9, 3.694253428220776*^9}, {3.694253581782907*^9, 
   3.6942535826686*^9}, 3.694253857859133*^9, {3.6942540176522923`*^9, 
   3.694254018297617*^9}, {3.694254074109559*^9, 3.694254076635468*^9}, {
   3.694254193679861*^9, 3.694254216584592*^9}, {3.6942542534155416`*^9, 
   3.694254272984798*^9}, {3.694254720895771*^9, 3.6942547437583227`*^9}, {
   3.694255139627845*^9, 3.694255143625621*^9}, {3.6942552519036827`*^9, 
   3.694255306775219*^9}, 3.694255434887721*^9, 3.694255489505278*^9, {
   3.694256129935514*^9, 3.694256234602985*^9}, {3.69425628797608*^9, 
   3.694256288782383*^9}, {3.6942564574784822`*^9, 3.694256557406045*^9}, {
   3.694256616910214*^9, 3.694256618716751*^9}, {3.694259971831324*^9, 
   3.6942600577739573`*^9}, {3.694260212055469*^9, 3.6942602464820223`*^9}, {
   3.6942602770403547`*^9, 3.694260394182578*^9}, {3.694260537254586*^9, 
   3.6942606593628693`*^9}, {3.694260721039516*^9, 3.694260811545753*^9}, {
   3.694261003259276*^9, 3.6942610664540577`*^9}, {3.694261117531528*^9, 
   3.694261282880632*^9}, {3.694261322330291*^9, 3.694261345671324*^9}, {
   3.694261424944531*^9, 3.694261454201067*^9}, {3.694261486995681*^9, 
   3.6942615051965513`*^9}, {3.6942616228323727`*^9, 
   3.6942616288247213`*^9}, {3.694261787738717*^9, 3.6942618322587643`*^9}, {
   3.694261912353158*^9, 3.6942619285668383`*^9}, {3.6942620309201393`*^9, 
   3.694262036324383*^9}, {3.6942620914745493`*^9, 3.694262101770258*^9}, {
   3.694262154313712*^9, 3.694262236637225*^9}, {3.6942624108247843`*^9, 
   3.6942624229722137`*^9}, {3.694262702718302*^9, 3.6942627350965652`*^9}, {
   3.69426277920222*^9, 3.694262780945825*^9}, {3.6942628707954197`*^9, 
   3.69426287139154*^9}, {3.694262905045092*^9, 3.6942629150440893`*^9}, {
   3.694263075689735*^9, 3.6942630809052687`*^9}, {3.694264230077352*^9, 
   3.69426435154524*^9}, {3.6942644059731627`*^9, 3.6942644086361628`*^9}, {
   3.694264516051903*^9, 3.6942645170653877`*^9}, {3.694264557796842*^9, 
   3.694264590908515*^9}, {3.694264633273019*^9, 3.694264644733671*^9}, {
   3.6942654746741867`*^9, 3.694266144957707*^9}, {3.694266318472547*^9, 
   3.694266854955555*^9}, {3.694275247855125*^9, 3.6942754401587067`*^9}, {
   3.6942759917667627`*^9, 3.694275994473586*^9}, {3.694276152262532*^9, 
   3.6942764076289*^9}, {3.694276512111793*^9, 3.694276515170196*^9}, {
   3.694276621299543*^9, 3.694276686266494*^9}, {3.694277372789278*^9, 
   3.694277477352888*^9}, {3.694277570210865*^9, 3.694277624679968*^9}, 
   3.6942776599582787`*^9, {3.694277979435556*^9, 3.694277986330534*^9}, {
   3.6942780259169817`*^9, 3.694278030979557*^9}, {3.694278124459029*^9, 
   3.6942781337767353`*^9}, {3.694278325243318*^9, 3.6942783408201714`*^9}, {
   3.6942784298416862`*^9, 3.694278434455244*^9}, {3.6942784686099243`*^9, 
   3.694278471024693*^9}, {3.694278549959125*^9, 3.6942785558131533`*^9}, {
   3.694279287665565*^9, 3.6942793032647953`*^9}, {3.694279402568571*^9, 
   3.694279417054563*^9}, {3.709321363527157*^9, 3.7093214054776373`*^9}, {
   3.709321503358892*^9, 3.709321511158869*^9}, {3.709321776501955*^9, 
   3.709321798330916*^9}, {3.709321830851821*^9, 3.709321862490981*^9}, {
   3.70932232477855*^9, 3.7093223652816067`*^9}, 3.709336072867181*^9, {
   3.709336138043647*^9, 3.7093362126186*^9}, 
   3.709336260962044*^9},ExpressionUUID->"3ded8bb1-cb38-4416-a5b1-\
fd10fdc7f23d"]
},
WindowSize->{1902, 1264},
WindowMargins->{{0, Automatic}, {Automatic, 62}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 15373, 272, 514, "Input",ExpressionUUID->"3ded8bb1-cb38-4416-a5b1-fd10fdc7f23d"]
}
]
*)

(* End of internal cache information *)

