(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12760,        296]
NotebookOptionsPosition[     12468,        283]
NotebookOutlinePosition[     12805,        298]
CellTagsIndexPosition[     12762,        295]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"CloudDeploy", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Delayed", "[", "\[IndentingNewLine]", 
    RowBox[{"APIFunction", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"RandomChoice", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         "1", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"binCt", "=", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"4", ",", "20"}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mean", "=", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "50"}], ",", "200"}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"stDev", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "10"}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"choiceNos", "=", 
           RowBox[{"RandomSample", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"20", ",", "400"}], "]"}], ",", "4"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dataCt", "=", 
           RowBox[{
           "choiceNos", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"data", "=", 
           RowBox[{"RandomVariate", "[", 
            RowBox[{
             RowBox[{"NormalDistribution", "[", 
              RowBox[{"mean", ",", " ", "stDev"}], "]"}], ",", " ", 
             "dataCt"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pic", "=", " ", 
           RowBox[{"Histogram", "[", 
            RowBox[{"data", ",", "binCt", ",", 
             RowBox[{"AxesStyle", "\[Rule]", "15"}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", 
              FractionBox["9", "8"]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "480", "}"}], ",", 
                RowBox[{"{", "540", "}"}]}], "}"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"q", "=", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<How many data points are represented in this histogram?\>\"",
              ",", 
             RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"choices", "=", 
           RowBox[{"ToString", "/@", "choiceNos"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mixed", "=", 
           RowBox[{"RandomSample", "[", "choices", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ans", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"mixed", ",", 
              RowBox[{
              "choices", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"InputForm", "[", 
           RowBox[{"{", 
            RowBox[{"q", ",", "ans", ",", "mixed", ",", "pic"}], "}"}], 
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mean", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"100", ",", "900"}], "}"}], ",", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"stDv", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"20", ",", "200"}], "}"}], ",", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"data", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"RandomVariate", "[", 
              RowBox[{
               RowBox[{"MixtureDistribution", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", "1.5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", 
                    RowBox[{
                    RowBox[{
                    "mean", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "stDv", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                   RowBox[{"NormalDistribution", "[", 
                    RowBox[{
                    RowBox[{
                    "mean", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "stDv", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "}"}]}], "]"}], ",",
                "400"}], "]"}], ",", 
             RowBox[{"d_", "/;", 
              RowBox[{"0", "\[LessEqual]", "d", "\[LessEqual]", "1000"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pic", "=", 
           RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
            RowBox[{"data", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1000", ",", "100"}], "}"}], ",", 
             "\"\<Probability\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"ChartStyle", "\[Rule]", 
              RowBox[{
               RowBox[{"ColorData", "[", "\"\<IslandColors\>\"", "]"}], "[", 
               RowBox[{"RandomReal", "[", "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "PlotLabel", "\[Rule]", "\"\<Relative Frequency Histogram\>\""}],
              ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Black", ",", "15"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "\[Rule]", 
              FractionBox["9", "8"]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "480", "}"}], ",", 
                RowBox[{"{", "540", "}"}]}], "}"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"qLim", "=", 
           RowBox[{"Sort", "[", 
            RowBox[{"RandomSample", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "1000", ",", "100"}], "]"}], ",", "2"}], 
             "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"q", "=", 
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<What is the probability that a data point fits `1` ?\>\"", 
             ",", 
             RowBox[{
              RowBox[{
              "qLim", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "<", "d", "\[LessEqual]", 
              RowBox[{
              "qLim", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ansNo", "=", 
           RowBox[{"100", "*", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{"data", ",", 
                 RowBox[{"d_", "/;", 
                  RowBox[{
                   RowBox[{
                   "qLim", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", "d", "\[LessEqual]", 
                   RowBox[{
                   "qLim", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}]}], "]"}], "/", 
               RowBox[{"Length", "[", "data", "]"}]}], ",", ".001"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"choices", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<%\>\""}], ",", 
               RowBox[{"\"\<.%\>\"", "\[Rule]", "\"\<%\>\""}]}], "]"}], "&"}],
             "/@", 
            RowBox[{"Take", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"RandomSample", "[", 
                   RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "1000"}], "]"}], ",", "4"}], "]"}], "/",
                   "10"}], "]"}], ",", "ansNo"}], "]"}], ",", "4"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mixed", "=", 
           RowBox[{"RandomSample", "[", "choices", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ans", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"mixed", ",", 
              RowBox[{
              "choices", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"InputForm", "[", 
           RowBox[{"{", 
            RowBox[{"q", ",", "ans", ",", "mixed", ",", "pic"}], "}"}], 
           "]"}]}]}], "]"}], "&"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", "\"\<CS_pack_Grap1\>\"", ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.682889938509007*^9, 3.682890139880888*^9}, {
   3.789481859083746*^9, 3.789481934745537*^9}, {3.789482891741467*^9, 
   3.789482957876811*^9}, {3.789483035966761*^9, 3.7894831202211246`*^9}, {
   3.7894832260944567`*^9, 3.789483227324667*^9}, {3.78948411853935*^9, 
   3.78948414598475*^9}, 3.789484288970015*^9, {3.789484417344499*^9, 
   3.7894847027345963`*^9}, {3.789484733167138*^9, 3.7894847528782177`*^9}, {
   3.789484795079638*^9, 3.7894848366302643`*^9}, {3.7894848995595713`*^9, 
   3.7894849225513973`*^9}, 3.7894849655834084`*^9, {3.789485012615494*^9, 
   3.789485066030787*^9}, {3.7894852272237577`*^9, 3.789485259824123*^9}, {
   3.7894855117750807`*^9, 3.789485522109921*^9}, {3.789485559175235*^9, 
   3.789485565478114*^9}, {3.789485688942339*^9, 3.789485697309058*^9}, {
   3.789485728438479*^9, 3.789485852004849*^9}, {3.789485883126526*^9, 
   3.789485923172625*^9}, {3.789485967717729*^9, 3.789485970764398*^9}, {
   3.78948622534083*^9, 3.789486281627488*^9}, {3.7894863207714853`*^9, 
   3.7894863211712437`*^9}, {3.789486352874874*^9, 3.789486371371063*^9}, {
   3.7894864597790728`*^9, 3.789486533514503*^9}, {3.789486577035729*^9, 
   3.789486605650391*^9}, {3.789486649483392*^9, 3.789486771569777*^9}, {
   3.789486808099373*^9, 3.789486827593429*^9}, {3.7894868599146643`*^9, 
   3.789486933961274*^9}, {3.789488190999373*^9, 3.789488202271275*^9}, {
   3.789488266541832*^9, 3.789488361151126*^9}, {3.7894884031893473`*^9, 
   3.78948851061296*^9}, {3.789488554941963*^9, 3.7894885785727873`*^9}, {
   3.789488681382551*^9, 3.789488684292262*^9}, {3.789488736173662*^9, 
   3.78948881319602*^9}, {3.789488844116523*^9, 3.789488863619588*^9}, {
   3.7894888958209047`*^9, 3.789488906076037*^9}, {3.789488939972786*^9, 
   3.789489034188048*^9}, {3.78948916950056*^9, 3.7894891774753532`*^9}, {
   3.7894892967480907`*^9, 3.789489304794504*^9}, {3.789489477202629*^9, 
   3.7894895065466433`*^9}, {3.7894896691312723`*^9, 3.789489700265773*^9}, {
   3.7894898706671133`*^9, 3.789489897896957*^9}},
 CellLabel->
  "In[589]:=",ExpressionUUID->"d1eb238f-f1b5-4b07-ae22-ebba9761ee1f"]
},
WindowSize->{1438, 1318},
WindowMargins->{{1, Automatic}, {Automatic, 6}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 11906, 261, 852, "Input",ExpressionUUID->"d1eb238f-f1b5-4b07-ae22-ebba9761ee1f"]
}
]
*)

