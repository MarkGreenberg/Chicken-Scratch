(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12679,        270]
NotebookOptionsPosition[     12328,        256]
NotebookOutlinePosition[     12724,        272]
CellTagsIndexPosition[     12681,        269]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"CloudDeploy", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Delayed", "[", "\[IndentingNewLine]", 
    RowBox[{"APIFunction", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ansV", "=", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "16000"}], ",", "16000"}], "}"}], ",", "4"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rands", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"390", ",", "730"}], "}"}], "]"}], ",", "27"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"known", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", 
             FractionBox[
              RowBox[{"FractionalPart", "[", "#", "]"}], "600"], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"#", ",", "25"}], "}"}]}], "}"}], "]"}]}], "}"}], 
          "&"}], "/@", "rands"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"obser", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", 
              FractionBox[
               RowBox[{"FractionalPart", "[", "#", "]"}], "600"], "]"}], ",", 
             
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "+", 
                   FractionBox[
                    RowBox[{"#", "*", 
                    RowBox[{
                    "ansV", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "300000"]}], ",", "25"}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "+", 
                   FractionBox[
                    RowBox[{"#", "*", 
                    RowBox[{
                    "ansV", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "300000"]}], ",", "50"}], 
                 "}"}]}], "}"}], "]"}]}], "}"}], ")"}], "&"}], "/@", 
         "rands"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pic", "=", 
        RowBox[{"DensityPlot", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "360", ",", "760"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0", ",", "50"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ColorFunction", "\[Rule]", "\"\<VisibleSpectrum\>\""}], 
          ",", 
          RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False", ",", "False", ",", "False"}], 
            "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "Black", ",", "known", ",", "obser", ",", "\[IndentingNewLine]", 
             "White", ",", "Thick", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"360", ",", "25"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"760", ",", "25"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<observed\>\"", ",", "16", ",", "Bold"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"740", ",", "37.5"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<at rest\>\"", ",", "16", ",", "Bold"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"745", ",", "12.5"}], "}"}]}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", "\"\<Wavelength (nm)\>\""}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Black", ",", "15"}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "12"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "940"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ansNo", "=", 
        RowBox[{
         FractionBox["offset", "560"], "*", "299792"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "q", "=", 
        "\"\<The Doppler shift of the observed object indicates that it is \
moving...\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"choices", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<`1` us at `2` km/s\>\"", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "<", "0"}], ",", "\"\<towards\>\"", ",", 
              "\"\<away from\>\""}], "]"}], ",", 
            RowBox[{"Abs", "[", "#", "]"}]}], "]"}], "&"}], "/@", "ansV"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"mixed", "=", 
        RowBox[{"RandomSample", "[", "choices", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ans", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"mixed", ",", 
           RowBox[{
           "choices", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"InputForm", "[", 
         RowBox[{"{", 
          RowBox[{"q", ",", "ans", ",", "mixed", ",", "pic"}], "}"}], "]"}], 
        "&"}]}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
   "\"\<CS_pack_Astr14\>\"", ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.700394148632395*^9, {3.7003941789674883`*^9, 3.700394183449849*^9}, {
   3.700394276125804*^9, 3.7003943127893953`*^9}, {3.700394356761454*^9, 
   3.700394397909573*^9}, {3.700394432133068*^9, 3.7003944460825453`*^9}, {
   3.700394499231406*^9, 3.700394504119081*^9}, {3.700394548506569*^9, 
   3.700394559849258*^9}, {3.700394624342101*^9, 3.700394644566146*^9}, {
   3.7003947275730247`*^9, 3.7003947598138742`*^9}, {3.700395141850687*^9, 
   3.700395169247809*^9}, {3.70039569303574*^9, 3.700395733609631*^9}, {
   3.700395785646688*^9, 3.7003957942234173`*^9}, {3.700395930334134*^9, 
   3.700395950268694*^9}, {3.7003959897445803`*^9, 3.700396048713722*^9}, 
   3.700396145287774*^9, {3.70039620937167*^9, 3.7003962421388617`*^9}, 
   3.70039638615586*^9, {3.70039643894258*^9, 3.700396494711557*^9}, {
   3.7003965733471413`*^9, 3.70039658417867*^9}, {3.700396671000318*^9, 
   3.7003966724476357`*^9}, {3.700397085700715*^9, 3.700397102900112*^9}, {
   3.700397254089911*^9, 3.70039726413264*^9}, 3.7003972972612257`*^9, {
   3.700397351621229*^9, 3.700397479461741*^9}, {3.700397542489306*^9, 
   3.700397607411861*^9}, {3.7003976780408983`*^9, 3.700397710912751*^9}, {
   3.700397813423568*^9, 3.700397836558909*^9}, {3.700397872034515*^9, 
   3.7003979121789217`*^9}, {3.700397961694684*^9, 3.700398003839037*^9}, {
   3.700398037130641*^9, 3.7003980750985126`*^9}, {3.700403583388454*^9, 
   3.700403646548541*^9}, {3.700403717250309*^9, 3.7004037390268097`*^9}, {
   3.7004037785090237`*^9, 3.700403819868482*^9}, {3.700403915443532*^9, 
   3.7004039157454243`*^9}, {3.700404061786762*^9, 3.700404166381768*^9}, {
   3.700404231242676*^9, 3.70040424221732*^9}, {3.7004043428486853`*^9, 
   3.7004043694074297`*^9}, {3.700404464757388*^9, 3.700404593162116*^9}, {
   3.700404770780634*^9, 3.7004047711707087`*^9}, {3.7004048130227327`*^9, 
   3.700404828469104*^9}, {3.700404965765793*^9, 3.700405072289192*^9}, {
   3.700405135302433*^9, 3.70040513619611*^9}, {3.70040545576556*^9, 
   3.700405476108761*^9}, {3.700405520737186*^9, 3.700405613220581*^9}, {
   3.700406069899352*^9, 3.7004060882901087`*^9}, {3.7004061627278347`*^9, 
   3.70040620605653*^9}, {3.7004062472677383`*^9, 3.700406251402398*^9}, {
   3.700406300967407*^9, 3.700406329525818*^9}, {3.700406364567689*^9, 
   3.70040644497928*^9}, {3.700406675144264*^9, 3.700406676774613*^9}, {
   3.700406751131913*^9, 3.700406871120407*^9}, {3.700406924931796*^9, 
   3.700407275315509*^9}, {3.7004074301809387`*^9, 3.7004074331393747`*^9}, {
   3.700407492535885*^9, 3.700407496982501*^9}, {3.700407529026367*^9, 
   3.7004075422890263`*^9}, {3.700407653190823*^9, 3.700407710288818*^9}, {
   3.7004077751348963`*^9, 3.700407879209077*^9}, {3.700407912236143*^9, 
   3.700407944124104*^9}, {3.700408047578949*^9, 3.700408106772946*^9}, {
   3.700408155262938*^9, 3.7004082544848633`*^9}, {3.70040828560079*^9, 
   3.7004083673926888`*^9}, {3.700408407595018*^9, 3.70040847134147*^9}, {
   3.700408741676755*^9, 3.7004087563794622`*^9}, {3.7004100030456743`*^9, 
   3.700410043207457*^9}, {3.7004101064995937`*^9, 3.7004101071858263`*^9}, 
   3.7004101707333593`*^9, {3.700410263851316*^9, 3.700410277170474*^9}, {
   3.700410314449*^9, 3.700410321068161*^9}, {3.700412252575732*^9, 
   3.7004123765974483`*^9}, {3.700412879620974*^9, 3.700412908365581*^9}, {
   3.700413366589119*^9, 3.700413379953886*^9}, {3.700413431854*^9, 
   3.700413450294335*^9}, {3.700413494657752*^9, 3.7004137093087063`*^9}, {
   3.700413844691313*^9, 3.7004138495925417`*^9}, {3.700413939638906*^9, 
   3.700413979840309*^9}, {3.700414064211067*^9, 3.700414073642083*^9}, 
   3.700414277836379*^9, {3.700414332606205*^9, 3.700414427138795*^9}, {
   3.700414469716948*^9, 3.7004146210276012`*^9}, {3.700414655439425*^9, 
   3.700414662605959*^9}, {3.700414698121375*^9, 3.7004147082814283`*^9}, {
   3.7004147475884132`*^9, 3.700414770427394*^9}, {3.700414852016912*^9, 
   3.700414856694392*^9}, {3.700415131232502*^9, 3.700415140156333*^9}, {
   3.700415175072266*^9, 3.700415190200536*^9}, {3.7004777551402082`*^9, 
   3.700477770681738*^9}, {3.700477887225814*^9, 3.7004779530043716`*^9}, {
   3.700478141958043*^9, 3.700478160708836*^9}, 3.70047844609861*^9, {
   3.700478550385005*^9, 3.700478567095825*^9}, {3.700478597563095*^9, 
   3.700478605113661*^9}, {3.700478666486539*^9, 3.700478695453815*^9}, {
   3.700478915130426*^9, 3.7004789159411087`*^9}, {3.700479271343244*^9, 
   3.7004793774305468`*^9}, {3.700479412593061*^9, 3.700479509556107*^9}, {
   3.700479572931839*^9, 3.700479623697591*^9}, {3.700479730016389*^9, 
   3.7004797678891087`*^9}, {3.700479934498061*^9, 3.700479961928904*^9}, {
   3.700480178741007*^9, 3.7004802275740623`*^9}, {3.716835572691029*^9, 
   3.716835587929699*^9}, {3.794750774421134*^9, 3.7947507905959883`*^9}, {
   3.794750881324032*^9, 3.7947509115481997`*^9}, {3.794751291649622*^9, 
   3.794751308969304*^9}, {3.794751347519841*^9, 3.794751360305159*^9}, {
   3.794751437210979*^9, 3.7947514821616373`*^9}, {3.794751518786427*^9, 
   3.7947515388343887`*^9}, {3.79475159146658*^9, 3.794751604850375*^9}, {
   3.794751693186036*^9, 3.794751770632825*^9}, {3.7947518250979347`*^9, 
   3.7947518422498083`*^9}, {3.794751898256625*^9, 3.794751899952105*^9}, {
   3.794751965525689*^9, 3.794751993392077*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"0a71ba1a-2820-4fb3-b55b-f1e8c6f14363"]
},
WindowSize->{1239, 1060},
WindowMargins->{{86, Automatic}, {Automatic, 88}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 13, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8d1c4ae1-9308-4a89-b0da-a6b44c80bb5b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 11766, 234, 587, "Input",ExpressionUUID->"0a71ba1a-2820-4fb3-b55b-f1e8c6f14363"]
}
]
*)

